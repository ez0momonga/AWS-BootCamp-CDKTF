# CDK to CDKTF Migration Workshop 学習ガイド

## 🎯 学習目標

このワークショップでは以下の技術スキルを習得できます：

### 1. Infrastructure as Code (IaC) の理解
- **AWS CDK**: TypeScriptでAWSリソースを定義する方法
- **CDKTF**: TypeScriptでTerraformリソースを定義する方法  
- **比較学習**: 2つのIaCツールの違いと使い分け

### 2. 実践的なAWSアーキテクチャ
- **ネットワーク**: VPC、サブネット、ゲートウェイの設計
- **セキュリティ**: セキュリティグループによる通信制御
- **負荷分散**: Application Load Balancerの設定
- **コンテナ**: ECS Fargateによるマイクロサービス

### 3. 移行プロジェクト管理
- **段階的移行**: フェーズ分割とリスク管理
- **ドキュメント化**: 移行過程の記録と知識共有
- **品質管理**: テスト・検証・リファクタリング

## 📚 前提知識

### 必要な知識
- **TypeScript**: 基本的な型システムと構文
- **AWS基礎**: VPC、EC2、ECS、ALBの基本概念
- **コンテナ**: Dockerとコンテナ化の基本
- **Git**: バージョン管理の基本操作

### 推奨する事前学習
- AWS公式ドキュメントでVPCとECSの概要を学習
- TypeScript公式チュートリアル
- Terraform基本概念（リソース、プロバイダー、状態管理）

## 🏗️ ワークショップ構成

### Phase 0: 準備・理解フェーズ（30分）
**目標**: プロジェクト全体の理解とツール準備
- [ ] CDKプロジェクトの分析
- [ ] CDKTFプロジェクトのセットアップ
- [ ] 移行計画の理解

**学習ポイント**:
- CDKとCDKTFの違い
- AWSアーキテクチャの全体像
- 移行戦略の考え方

### Phase 1: 環境設定（20分）
**目標**: CDKTF基本設定とプロバイダー設定
- [ ] AWS プロバイダーの設定
- [ ] プロバイダーバインディングの生成
- [ ] 基本的な構文確認

**学習ポイント**:
- CDKTFプロジェクトの初期化方法
- Terraformプロバイダーの概念
- `cdktf get` コマンドの役割

### Phase 2: ネットワーク基盤（45分）
**目標**: VPC、サブネット、ゲートウェイの構築
- [ ] VPCの作成
- [ ] サブネット設計（パブリック/プライベート）
- [ ] インターネットゲートウェイ・NATゲートウェイ
- [ ] ルートテーブル設定

**学習ポイント**:
- ネットワークアーキテクチャの設計思想
- マルチAZ構成の意義
- CDKの自動化 vs CDKTFの明示的設定

### Phase 3: セキュリティ設定（25分）
**目標**: セキュリティグループとファイアウォールルール
- [ ] ALB用セキュリティグループ
- [ ] ECS用セキュリティグループ  
- [ ] セキュリティルールの定義

**学習ポイント**:
- セキュリティグループの設計原則
- 最小権限の原則
- セキュリティルール管理の違い（CDK vs CDKTF）

### Phase 4: 負荷分散（30分）
**目標**: Application Load Balancerの設定
- [ ] ALBの作成
- [ ] ターゲットグループの設定
- [ ] リスナーとルーティングルール

**学習ポイント**:
- ロードバランサーの種類と使い分け
- ヘルスチェック設計
- 高可用性の実現方法

### Phase 5: コンテナ基盤（40分）
**目標**: ECSクラスターとコンテナサービス
- [ ] ECRリポジトリ
- [ ] ECSクラスター
- [ ] IAMロール設定
- [ ] タスク定義
- [ ] ECSサービス

**学習ポイント**:
- コンテナオーケストレーションの概念
- Fargate vs EC2起動タイプ
- IAMロールとセキュリティ
- サービス発見とロードバランシング

### Phase 6: 検証・最適化（30分）
**目標**: 動作確認と改善
- [ ] デプロイメント検証
- [ ] 接続テスト
- [ ] パフォーマンス確認
- [ ] コードレビュー

**学習ポイント**:
- IaC品質管理
- 監視とロギング
- トラブルシューティング

## 🛠️ 実習環境

### 必要なツール
```bash
# Node.js (>= 20.9)
node --version

# npm パッケージ
npm install -g cdktf-cli

# AWS CLI設定（認証情報）
aws configure list
```

### ディレクトリ構成の理解
```
AWS-Workshop/
├── cdk/                    # 参照用CDKプロジェクト（編集禁止）
│   ├── lib/
│   │   └── aws-workshop-stack.ts
│   └── bin/
│       └── aws-workshop.ts
└── cdktf/                  # 作業用CDKTFプロジェクト
    ├── docs/               # 学習ドキュメント
    ├── main.ts            # メインスタック
    └── package.json
```

## 💡 学習のコツ

### 1. 比較学習の活用
- CDK実装を先に理解する
- 同等のCDKTF実装を考える
- 違いがなぜ生まれるかを理解する

### 2. ドキュメント活用
- 各フェーズの詳細ドキュメントを確認
- トラブルシューティングガイドを参照
- 移行進捗を記録する

### 3. 段階的な理解
- 一度にすべてを理解しようとしない
- 各フェーズで動作確認を行う
- 疑問点はその場で解決する

### 4. 実践的なアプローチ
- コードを書いて動作確認
- エラーメッセージから学ぶ
- AWSコンソールで結果を確認

## 🎓 期待される学習成果

### 技術的スキル
- CDKとCDKTFの使い分けができる
- AWSネットワーキングの基本を理解している
- コンテナベースのアプリケーション構築ができる
- Infrastructure as Codeの利点を説明できる

### 実践的スキル  
- 移行プロジェクトの計画・実行ができる
- 技術的ドキュメントの作成ができる
- トラブルシューティングの基本手法を身につける
- コードレビューとリファクタリングができる

## 📞 サポート体制

### 質問・相談
1. **ドキュメント確認**: `docs/troubleshooting.md`
2. **進捗記録**: `docs/migration-progress.md` を更新
3. **講師への質問**: 具体的なエラーメッセージと実行手順を準備

### 緊急時の対応
- 作業を中断して安全な状態にロールバック
- 変更内容を `migration-progress.md` に記録
- 講師と復旧手順を相談